(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{7490:function(t,e,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/weather",function(){return i(2623)}])},2623:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return tn}});var n=i(5893),s=i(5081),a=i(1944),r=i(6226),l=i(9528),h=i(7029),o=i(8795),d=i(7294),c=i(1649),g=i(6030),u=i(7484),x=i.n(u),y=i(9760),f=i(6105),m=i(2269),w=i(6833),j=i.n(w),p=i(5675),v=i.n(p);let C={isThunderstorm:[15,16,17,18,21,22,33,34,35,36,41],isClear:[1],isCloudyFog:[25,26,27,28],isCloudy:[2,3,4,5,6,7],isFog:[24],isPartiallyClearWithRain:[8,9,10,11,12,13,14,19,20,29,30,31,32,38,39],isSnowing:[23,37,42]},T={width:"100%",height:"100%"},P={day:{isThunderstorm:(0,n.jsx)(v(),{src:"/images/day-thunderstorm.svg",alt:"Day Thunderstorm",style:T,width:150,height:150}),isClear:(0,n.jsx)(v(),{src:"/images/day-clear.svg",alt:"Day Clear",style:T,width:150,height:150}),isCloudyFog:(0,n.jsx)(v(),{src:"/images/day-cloudy-fog.svg",alt:"Day Cloudy Fog",style:T,width:150,height:150}),isCloudy:(0,n.jsx)(v(),{src:"/images/day-cloudy.svg",alt:"Day Cloudy",style:T,width:150,height:150}),isFog:(0,n.jsx)(v(),{src:"/images/day-fog.svg",alt:"Day Fog",style:T,width:150,height:150}),isPartiallyClearWithRain:(0,n.jsx)(v(),{src:"/images/day-partially-clear-with-rain.svg",alt:"Day Partially Clear With Rain",style:T,width:150,height:150}),isSnowing:(0,n.jsx)(v(),{src:"/images/day-snowing.svg",alt:"Day Snowing",style:T,width:150,height:150})},night:{isThunderstorm:(0,n.jsx)(v(),{src:"/images/night-thunderstorm.svg",alt:"Night Thunderstorm",style:T,width:150,height:150}),isClear:(0,n.jsx)(v(),{src:"/images/night-clear.svg",alt:"Night Clear",style:T,width:150,height:150}),isCloudyFog:(0,n.jsx)(v(),{src:"/images/night-cloudy-fog.svg",alt:"Night Cloudy Fog",style:T,width:150,height:150}),isCloudy:(0,n.jsx)(v(),{src:"/images/night-cloudy.svg",alt:"Night Cloudy",style:T,width:150,height:150}),isFog:(0,n.jsx)(v(),{src:"/images/night-fog.svg",alt:"Night Fog",style:T,width:150,height:150}),isPartiallyClearWithRain:(0,n.jsx)(v(),{src:"/images/night-partially-clear-with-rain.svg",alt:"Night Partially Clear With Rain",style:T,width:150,height:150}),isSnowing:(0,n.jsx)(v(),{src:"/images/night-snowing.svg",alt:"Night Snowing",style:T,width:150,height:150})},airFlow:(0,n.jsx)(v(),{src:"/images/weather-icon/air-flow.svg",alt:"Air Flow",style:T,width:150,height:150}),celsius:(0,n.jsx)(v(),{src:"/images/weather-icon/celsius.svg",alt:"Celsius",style:T,width:150,height:150}),tCold:(0,n.jsx)(v(),{src:"/images/weather-icon/t-cold.svg",alt:"T Cold",style:T,width:150,height:150}),tHot:(0,n.jsx)(v(),{src:"/images/weather-icon/t-hot.svg",alt:"T Hot",style:T,width:150,height:150}),umbrella:(0,n.jsx)(v(),{src:"/images/weather-icon/umbrella.svg",alt:"Umbrella",style:T,width:150,height:150})},b=t=>{let e=t.iconKey;return P[e]},Z=t=>{let{typeNumber:e,dayNightKey:i}=t;for(let t in C)if(C[t].includes(parseInt(e)))return P[i][t];return(0,n.jsx)(n.Fragment,{})};var S=i(2729),_=i(4589);function N(){let t=(0,S._)(["\n    position: relative;\n    padding: 5px;\n"]);return N=function(){return t},t}function D(){let t=(0,S._)(["\n    height: 50px;\n    text-align: left;\n    font-size: 28px;\n"]);return D=function(){return t},t}function F(){let t=(0,S._)(["\n    height: 25px;\n    text-align: left;\n    font-size: 16px;\n    color: #828282;\n"]);return F=function(){return t},t}function k(){let t=(0,S._)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    height: 140px;\n    width: ",";\n"]);return k=function(){return t},t}function E(){let t=(0,S._)(["\n    font-size: 90px;\n    font-weight: 300;\n    display: flex;\n"]);return E=function(){return t},t}function Y(){let t=(0,S._)(["\n    width: 60px;\n    height: 70px;\n    margin-top: -26px;\n"]);return Y=function(){return t},t}function z(){let t=(0,S._)(["\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    height: 50px;\n    width: ",";\n"]);return z=function(){return t},t}function M(){let t=(0,S._)(["\n    flex: 0 0 45px;\n"]);return M=function(){return t},t}function W(){let t=(0,S._)(["\n    flex: 0 0 100px;\n    font-size: 26px;\n    font-weight: 300;\n    display: flex;\n"]);return W=function(){return t},t}function O(){let t=(0,S._)(["\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n    height: 50px;\n    width: ",";\n"]);return O=function(){return t},t}let H={width:"290px"},K=_.ZP.div(N()),R=_.ZP.div(D()),L=_.ZP.div(F()),U=_.ZP.div(k(),H.width),A=_.ZP.div(E()),V=_.ZP.div(Y()),X=_.ZP.div(z(),H.width),G=_.ZP.div(M()),I=_.ZP.div(W()),q=_.ZP.div(O(),H.width);x().extend(j());let B=t=>{let{currentDate:e,data:i,region:a}=t,[l,h]=(0,d.useState)(Object.keys(i.day).length>0?"day":"night"),[o,c]=(0,d.useState)(i[l]),[g,u]=(0,d.useState)("day"===l),[y,w]=(0,d.useState)(!1);return(0,n.jsx)(r.Z,{xl:8,md:12,xs:24,align:"center",children:(0,n.jsx)(s.Z,{spinning:y,tip:"Loading...",style:{marginTop:"5%"},children:(0,n.jsxs)(f.Z,{className:"highlight-card",style:{borderColor:"black"},bodyStyle:{height:450,width:330,padding:5},children:[(0,n.jsx)("strong",{style:{fontSize:24},children:"".concat(e," ").concat(x()(e).format("dddd"))}),(0,n.jsxs)(K,{children:[(0,n.jsx)(R,{children:a}),(0,n.jsx)(L,{children:o.Wx[0]}),(0,n.jsxs)(U,{children:[(0,n.jsxs)(A,{children:[o.T,(0,n.jsx)(V,{children:(0,n.jsx)(b,{iconKey:"celsius"})})]}),(0,n.jsx)(Z,{typeNumber:o.Wx[1],dayNightKey:l})]}),(0,n.jsxs)(X,{children:[(0,n.jsx)(G,{children:(0,n.jsx)(b,{iconKey:"tCold"})}),(0,n.jsx)(I,{children:"".concat(o.MinT,"\xb0C")}),(0,n.jsx)(G,{children:(0,n.jsx)(b,{iconKey:"tHot"})}),(0,n.jsx)(I,{children:"".concat(o.MaxT,"\xb0C")})]}),(0,n.jsxs)(X,{children:[(0,n.jsx)(G,{children:(0,n.jsx)(b,{iconKey:"airFlow"})}),(0,n.jsx)(I,{children:"".concat(o.WS," m/s")}),(0,n.jsx)(G,{children:(0,n.jsx)(b,{iconKey:"umbrella"})}),(0,n.jsxs)(I,{children:[" "!==o.PoP12h?"".concat(o.PoP12h,"%"):"NULL"," "]})]}),(0,n.jsx)(q,{children:(0,n.jsx)(m.Z,{checkedChildren:"白天",unCheckedChildren:"夜晚",checked:g,onChange:t=>{w(!0),u(t),setTimeout(()=>{h(t?"day":"night"),c(i[t?"day":"night"]),w(!1)},1e3)},disabled:0===Object.keys(i.day).length||0===Object.keys(i.night).length})})]})]})})})},J=t=>{let e=(0,c.v9)(t=>t.weatherData.weatherData);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),(0,n.jsx)(a.Z,{gutter:[10,10],align:"middle",children:Object.keys(e).filter(t=>x()(t).isBefore(x()().add(6,"day"))).map(i=>(0,n.jsx)(B,{currentDate:i,data:e[i],region:t.region},i))})]})};async function Q(){try{let t=await fetch("/api/config");if(!t.ok)throw Error("Failed to fetch config");let e=await t.json();return e}catch(t){throw console.error(t),t}}async function $(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{let n={method:e.toUpperCase()};if(i){if("GET"===n.method||"HEAD"===n.method){let e=new URLSearchParams(i).toString();t+="?"+e}else n.body=JSON.stringify(i)}let s=await fetch(t,n);if(!s.ok){let t=Error("網路回應不正確");throw t.status=s.status,t.statusText=s.statusText,t}return await s.json()}catch(t){return console.log(t),{status:t.status||response&&response.status,statusText:t.statusText||response&&response.statusText}}}async function tt(t,e,i){return await $(t,e,i)}let te=["基隆市","臺北市","新北市","桃園市","新竹縣","新竹市","苗栗縣","臺中市","彰化縣","南投縣","雲林縣","嘉義縣","嘉義市","臺南市","高雄市","屏東縣","宜蘭縣","花蓮縣","臺東縣","澎湖縣","金門縣","連江縣"],ti=()=>{let t=(0,d.useRef)(null),[e,i]=(0,d.useState)([]),[u,f]=(0,d.useState)(te[0]),[m,w]=(0,d.useState)(),[j,p]=(0,d.useState)(!1),v=(0,c.I0)(),C=x()().isAfter(x()().set("hour",6).startOf("hour"))?x()():x()().subtract(1,"day"),T=async()=>{p(!0);let e=await Q(),i=(0,g.Z)({targets:t.current,translateX:[-300,0],duration:2e3,easing:"easeOutExpo"}),s=await tt(e.requestUrl,"GET",{Authorization:e.authorizationKey,locationName:u,elementName:"T,Wx,MaxT,MinT,PoP12h,WS"}),a={};if(s.success){let t=s.records.locations[0].location[0].weatherElement;for(let t=0;t<=7;t++){let e=C.add(t,"day").format("YYYY-MM-DD");a[e]={day:{},night:{}}}t.map(t=>{t.time.map(e=>{let i="00"===x()(e.startTime).format("HH")?x()(e.startTime).subtract(1,"day").format("YYYY-MM-DD"):x()(e.startTime).format("YYYY-MM-DD"),n="18"===x()(e.endTime).format("HH")?"day":"night";a[i][n][t.elementName]="Wx"!==t.elementName?e.elementValue[0].value:[e.elementValue[0].value,e.elementValue[1].value]})}),setTimeout(()=>{v((0,y.LM)(a)),w((0,n.jsx)(J,{region:u})),p(!1)},500)}else setTimeout(()=>{p(!1)},500);setTimeout(()=>{i.pause()},2e3)};return(0,d.useEffect)(()=>{let t=te.map(t=>({label:t,value:t}));i(t)},[]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s.Z,{spinning:j,tip:"Loading...",size:"large",style:{marginTop:"15%"},children:[(0,n.jsxs)(a.Z,{gutter:[10,10],align:"middle",children:[(0,n.jsx)(r.Z,{xl:4,md:8,xs:24,align:"center",children:(0,n.jsx)("strong",{style:{fontSize:20},children:"區域："})}),(0,n.jsx)(r.Z,{xl:16,md:16,xs:24,children:(0,n.jsx)(l.Z,{showSearch:!0,size:"large",defaultValue:u,onChange:t=>f(t),style:{width:"100%"},options:e})}),(0,n.jsx)(r.Z,{xl:4,md:24,xs:24,children:(0,n.jsx)(h.ZP,{icon:(0,n.jsx)(o.Z,{}),size:"large",style:{width:"100%"},onClick:()=>T(),children:"Search"})})]}),(0,n.jsxs)("div",{ref:t,children:[" ",m]})]})})};var tn=ti}},function(t){t.O(0,[373,774,888,179],function(){return t(t.s=7490)}),_N_E=t.O()}]);